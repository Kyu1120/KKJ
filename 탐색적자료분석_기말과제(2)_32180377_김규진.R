library(dplyr)
library(ggplot2)
library(corrgram)
library(corrplot)
library(ggcorrplot)
## ?????? ??Ã³
# https://www.kaggle.com/datasets/prestonrobertson7/league-of-legends-data-9292022

## ?????? ??Á¤ ??À¯?? ?????? ?Ò°?
# ???? ????À» ???? ??À¸?? ?Ï°? ?Í´Ù´? ????À» ?????? ?Ö½À´Ï´?. 
# ?????? ?Ð¼????Î½? ??????À¸?? ????À» ?Ï±? À§?Ø¼? ???? ?????Í¸? 
# ?Ð¼??? ?? ?Ë¾Æ¾? ?Ñ´Ù°? ?????ß½À´Ï´?. 
# ?×·? ??À¯?? ???? Á¦?? ???Õ°? ?????? ?Ö´? ???????? ?Î±â¸¦ ???? ?Ö´?
# ???? ?Àº? ?????????? ???? ?????Í¸? ?????? ?Ô½À´Ï´?. 
# ???? ?Àº? ???????? AOS ?å¸£?? 5???Ì¼? ?????? ?Ç¾? ???????? ?Ø¼??????? ?Ç¹?À» 
# ?Ä±???1?? ?Ç´? ?????Ô´Ï´?. 5??Àº ???? ?Ù¸? ??????À» ?????? ?Ç°? ?? ??????Àº 
# Å¾, Á¤??, ?Ìµ?, ????, À¯Æ¿?? ?Ö½À´Ï´?. 5?? ???? Ã¨?Ç¾??Ì¶??? ?Ò¸??? Ä³???Í¸? ?Ñ°????? ????
# ?Ú½??? ??????À¸?? ???? ???????? ?????Ï°? ?Ë´Ï´?. Ã¨?Ç¾??? Á¾???? ?Å¿? ?Ù¾??Ï°? Ã¨?Ç¾? ????
# ?âº»??Å³ 3?????? ?Ã±? ??Å³ 1?????? ???Ï°? ?Ö½À´Ï´?. ????, ??È¯?? ?Ö¹??Ì¶??? ???Î°? ????À¸?? 
# ?????? ??Å³ 2?????? ???? ?? ?Ö½À´Ï´?. ?Ì·??? Ã¨?Ç¾? ?? ??Å³??À» ?Ì¿??Ï¿? ??????À» ???Å³? 
# ???? ???????? ???Å³???(?Ù·?) ?? ??, ?×¸??? Á¤?? ?????Íµ?À» ???? ??À» ???? ?Ç°? 
# ?? ??À¸?? ?? 6???? ??????À» ?? ?? ?Ö½À´Ï´?. ?? ???Ó¸??? 15?Ð¿? Á¶?? ?×º?À» ?? ???? ?Ö°?, 
# 20?Ð¿? ?×º?À» ?? ?? ?Ö½À´Ï´?. Á¶?? ?×º?Àº ??????Ä¡ ?×º?Àº 5?? ?? 4?í¸¸ ?????Ï¿??? ?Ë´Ï´?.
# Á¦?? ??Á®?? ?????Í´? ?? 10,000???? ???? ?????Í·? ?? ???? ?? 10???Ì¼? ?Ï´? ?????? ??Å­
# ??Àº ???? ID?? ???? ?????Í°? ?? 10?? ?? Á¸???Ï¿? 100,000???? ???? Á¸???Ï´? ???????Ô´Ï´?. 

## ?????? ???? ?Ò°? 
# GameID: 10000???? ????À» ?????? ?? ?Ö´? ID?? ?? ???Ó´? 10???? ?Ã·??Ì¾î°¡ Á¸???Ï¹Ç·? 10???? ??Àº ???? Á¸??
# GameMode: LOL???? ??Å©???? ?Ï¹Ý°??? Ä®?Ù¶????? ?? ??Àº ???? ???å°¡ ??????, ???? CLASSIC?? Á¸??
# assists: ???? ?????? killÀ» ???Âµ??? ????À» ?? È½??
# baronkills: ???? ???? ???? ???????? baronÀ» ??Àº È½??
# bountyLevel: ???? ???? Á¸???Ï´? ?????? ?Ã½???À¸?? ???Ú°? ??À»???? ?? À¯???? ????À» ?? ??À» ?? ???? ?? (?????? ????)
# champExperience: ???? ???? Á¸???Ï´? Ã¨?Ç¾??? ???Ãµ? 
# champLevel: ???? ?Ã·??Ì½? Ã¨?Ç¾??? ???? 18?? ?Ö´?
# championName: Ã¨?Ç¾??? ?Ì¸? 
# damageDealtToObjectives: Ã¨?Ç¾??? ?Æ´? ?Ù¸? ???? ?? ??????
# damageSelfMitigated: ??È£???Ì³? ?î¶°?? ?É·?À¸?? ?Ù¾??? ?????? 
# deaths: ??Àº È½?? 
# dragonKills: ?Ì¹? ???Ó³????? ??À» ??Àº È½??
# firstBloodAssist: ????Á¡À» ???Âµ? ????À» ?Ö¾??Â°? (?????? ???? T/F)
# fitstBloodKill: ????Á¡À» ?????Â°? (?????? ???? T/F)
# gameEndedInSurrender: ?×º?À¸?? ?????? ?????Â°? (?????? ???? T/F)
# goldEarned: ???? ?????? È¹???? ?????? ??
# goldSpent: ???? ?????? ?????? ?????? ??
# individualPosition: ???? ???????? ?????? (?????? ????)
# inhibitorKills: ?? ??Á¦???? ??
# inhibitorLost: ??Àº ??Á¦???? ??
# item0-6: ???????? ??À¯ ??È£ (?????? ????)
# kills: ?Ì¹? ???Ó¿??? ?????î³½ Å³ ??
# lane: ?? ?????? ?Ì¸? (?????? ????)
# largestCriticalStrike: Ä¡??Å¸?? ?????î³½ ?Ö´? ??????
# largestKillingSpree: ?????Ê°? ?Ö´? ????À¸?? ???? Å³ ??
# longestTimeSpentLiving: ?Ö´??? ?????Ê°? ?????Ö´? ?Ã°?
# magicDamageDealtToChampions: Ã¨?Ç¾ð¿¡°? ???? ???????????? 
# magicDamageTaken: Ã¨?Ç¾ð¿¡°? ??Àº ????????????
# nexusLost: ??Àº ?Ø¼??? ???? 
# objectivesStolen: ???? Á¤?? ?????Í¸? ???? È½??
# physicalDamageDealtToChampions: Ã¨?Ç¾ð¿¡°? ???? ????????????
# physicalDamageTaken: Ã¨?Ç¾ð¿¡°? ??Àº ????????????
# spell 1-4 Casts: ??Å³ ???? È½??
# summoner1Casts: ??È¯?? ??Å³1 ???? È½??
# summoner1ID: ??È¯?? ??Å³1?? ??À¯ ??È£ (?????? ????)
# summoner2Casts: ??È¯?? ??Å³2 ???? È½??
# summoner2ID: ??È¯?? ??Å³2?? ??À¯ ??È£ (?????? ????)
# summonerID: ???? À¯???? ??À¯ ID (?????? ????)
# teamEarlySurrendered: ???? Á¶???×º?À» ?Ï¿??Â°? (?????? ???? T/F)
# teamID: ?Ä¶??????? ?????????? ?Ë·??Ö´? ??À¯??È£ (?????? ????, 100:BLUE, 200:RED)
# timeCCingOthers: ?????æ¿¡?? ?Ìµ??Ò°??? ???? ?Ã°?
# timePlayed: ????À» ?Ã·????? ?Ã°?
# totalDamageDealtToChampions: Ã¨?Ç¾ð¿¡°? ???? ??Ã¼ ??????
# totalDamageShieldedOnTeammates: ?ì¸®?À¿??? ??È£??À» ?Ö¾? ?????? ?????? 
# totalDamageTaken: Ã¨?Ç¾ð¿¡°? ??Àº ??Ã¼ ??????
# totalHeal: È¸????
# totalHealsOnTeammates: ?ì¸®??À» È¸????Å² ??
# totalMinionsKilled: ??Àº ?Ì´Ï¾? ?? 
# totalTimeCCdealt: cc?? ?É·??Ö¾??? ?Ã°?
# totalTimeSpentDead: ?×¾??Ö´? ?Ã°?
# trueDamageDealtToChampions: Ã¨?Ç¾ð¿¡°? ???? ??Á¤????????
# trueDamageTaken: Ã¨?Ç¾ð¿¡°? ??Àº ??Á¤????????
# turretTakedowns: Á¦???? Å¸?? ??
# visionScore: ?Ã¾?Á¡??
# visionWardsBoughtInGame: ?Ì¹? ???Ó¿??? ?Íµå¸¦ ?? È½??
# wardsKilled: ?Íµå¸¦ Á¦???? È½??
# wardsPlaced: ?Íµå¸¦ ??Ä¡?? È½??
# win: ?Ì°??Â°? Á³?Â°? (?????? ???? T/F)

## ?Ð¼???Ç¥
# 1. ?Æ¹????? ???? ?????Ì°? ??Àº Ã¨?Ç¾????? ?????Ûµ??? Á¸???Ï¹Ç·? ?????Ûµ??? Ã¨?Ç¾??? ???? 
#    ?Â·????Ì°? ???? ?? ?Ö½À´Ï´?. ??????, ?Ê¹? ?Â·??? ??Àº Ã¨?Ç¾??Ì³?, ?????Û°?Àº ???? 
#    ?????Ï¿? ?ë·±??À» ?? ?? ?Ö½À´Ï´?.
# 2. ?î¶°?? ???Ó³??????? ??Ç¥???? ?Â¸??? ?Ì²??????? È®???Ï¿?, ?Â¸??? ?? ???????? ?? ?Öµ??? 
#    ???Ó³????? ????À» ?????Ï°? ???? ?Ã·??Ì¸? ?? ?? ?Ö½À´Ï´?.
# 3. ???Ó³??? ??Ç¥?? ???Ï¿? ???Ó³????? ???Ç·? ?×°Å³? ????À» ?????Ï´? À¯???? ?????Ï¿? ????À» ????
#    ???Õ°? ???? ?? ?Ö½À´Ï´?.



## ?????? ?Ò·??À±?, ?????? Á¤??
LOL <- read.csv("Sep-09-2022_10000matches.csv", header = T)
LOL <-LOL[,-1]
LOL <-LOL %>% relocate(assists, .after = GameMode)
head(LOL)

## GameID NA ??Á¦
LOL <- LOL[-1,]
rownames(LOL)<-NULL
head(LOL)
# ?Ù¸? Game ID ?Í´? ?Ù¸? ?????? 1???? ?? Á¦??

## ?Ê¿????? ???? ??Á¦
sum(is.na(LOL))
colnames(LOL)
LOL <- LOL[,-c(29, 47)]
# Lane ???? ??Àº ????, NONE ???? ???ÔµÇ¾? ?Ö°? individualPosition ?????? ?ßº??Ç´? 
# ?????? ?Ö±? ?????? Á¦??
# summonerID ???? ??Àº ????, ?Úµ??? ?Ù¸? ?????? ?Ç¾??Ö´Â°? ???? GameID?? ?Ù¸? ??????
# ??À» ?????? ?? ?Ö´Ù°? ?????Ï¿? Á¦??

## ?????? ???? ??È¯
LOL$item0 <- as.factor(LOL$item0)
LOL$item1 <- as.factor(LOL$item1)
LOL$item2 <- as.factor(LOL$item2)
LOL$item3 <- as.factor(LOL$item3)
LOL$item4 <- as.factor(LOL$item4)
LOL$item5 <- as.factor(LOL$item5)
LOL$item6 <- as.factor(LOL$item6)
LOL$summoner1Id <- as.factor(LOL$summoner1Id)
LOL$summoner2Id <- as.factor(LOL$summoner2Id)
LOL$teamId <- as.factor(LOL$teamId)
str(LOL)

## ?????? ?Ð¼? 
ggplot(LOL, aes(x=GameMode)) + geom_bar()
ggplot(LOL, aes(x=assists)) + geom_bar()
ggplot(LOL, aes(x=baronKills)) + geom_bar()
ggplot(LOL, aes(x=bountyLevel)) + geom_bar()
hist(LOL$champExperience)
boxplot(LOL$champLevel); hist(LOL$champLevel); ggplot(LOL, aes(x=champLevel)) + geom_bar()
hist(LOL$damageDealtToObjectives)
hist(LOL$damageSelfMitigated)
boxplot(LOL$deaths)
boxplot(LOL$dragonKills)
ggplot(LOL, aes(x=firstBloodAssist)) + geom_bar()
ggplot(LOL, aes(x=firstBloodKill)) + geom_bar()
ggplot(LOL, aes(x=gameEndedInSurrender)) + geom_bar()
hist(LOL$goldEarned)
hist(LOL$goldSpent)
ggplot(LOL, aes(x=individualPosition)) + geom_bar() 
#invalid ?? ??Àº ???? ????À» ?????Å³? Á¤?????? ?Ã·??Ì¸? ???? ?Ê´? ???????? ?Ç´? ?×·??? ??Á¦?? X ?ß¿??? ???Ï¼???
ggplot(LOL, aes(x=inhibitorKills)) + geom_bar()
ggplot(LOL, aes(x=inhibitorsLost)) + geom_bar()
levels(LOL$item0)
ggplot(LOL, aes(x=item0)) + geom_bar()
levels(LOL$item1)
ggplot(LOL, aes(x=item1)) + geom_bar()
levels(LOL$item2)
ggplot(LOL, aes(x=item2)) + geom_bar()
levels(LOL$item3)
ggplot(LOL, aes(x=item3)) + geom_bar()
levels(LOL$item4)
ggplot(LOL, aes(x=item4)) + geom_bar()
levels(LOL$item5)
ggplot(LOL, aes(x=item5)) + geom_bar()
levels(LOL$item6)
ggplot(LOL, aes(x=item6)) + geom_bar()
ggplot(LOL, aes(x=kills)) + geom_bar()
boxplot(LOL$largestCriticalStrike)
ggplot(LOL, aes(x=largestKillingSpree)) + geom_bar()
boxplot(LOL$longestTimeSpentLiving)
hist(LOL$magicDamageDealtToChampions)
hist(LOL$magicDamageTaken)
ggplot(LOL, aes(x=nexusLost)) + geom_bar()
ggplot(LOL, aes(x=objectivesStolen)) + geom_bar()
hist(LOL$physicalDamageDealtToChampions)
hist(LOL$physicalDamageTaken)
hist(LOL$spell1Casts)
hist(LOL$spell2Casts)
hist(LOL$spell3Casts)
hist(LOL$spell4Casts)
hist(LOL$summoner1Casts)
hist(LOL$summoner2Casts)
ggplot(LOL, aes(x=teamEarlySurrendered)) + geom_bar()
ggplot(LOL, aes(x=teamID)) + geom_bar()
hist(LOL$timeCCingOthers)
hist(LOL$timePlayed)
hist(LOL$totalDamageDealtToChampions)
hist(LOL$totalDamageShieldedOnTeammates)
hist(LOL$totalDamageTaken)
hist(LOL$totalHeal)
hist(LOL$totalHealsOnTeammates)
hist(LOL$totalMinionsKilled)
hist(LOL$totalTimeCCDealt)
hist(LOL$totalTimeSpentDead)
hist(LOL$trueDamageDealtToChampions)
hist(LOL$trueDamageTaken)
ggplot(LOL, aes(x=turretTakedowns)) + geom_bar()
ggplot(LOL, aes(x=turretsLost)) + geom_bar()
hist(LOL$visionScore)
hist(LOL$visionWardsBoughtInGame)
hist(LOL$wardsKilled)
hist(LOL$wardsPlaced)

## ???????? ?Ð¼?
cor(LOL[,-c(1, 2, 8, 13, 14, 15, 18, 21, 22, 23, 24, 25, 26, 27, 43, 45, 46, 47, 66)])
cor.test(LOL$longestTimeSpentLiving, LOL$deaths)

## ???? ????
LOL$kda <- (LOL$kills + LOL$assists)/LOL$deaths

